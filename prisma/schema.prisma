generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}


model User {
  id             Int            @id @default(autoincrement())
  firstName      String?
  lastName       String?
  nickName       String?
  profile        String            @default("https://res.cloudinary.com/dajtfamck/image/upload/v1735917511/bygk2ftxmju3gxseehtl.jpg")
  phone          String?
  hashPass       String?
  email          String            @unique
  role           String @default("USER")
  birthDay       DateTime?
  orderTrack     OrderTracking[]
  addresses      Addresses[]
  commentsFood   CommentsFood[]
  commentsBranch CommentsBranch[]
  favorite       Favorite?
}

model Favorite {
  id     Int  @id @default(autoincrement())
  user   User    @relation(fields: [userId], references: [id])
  userId Int  @unique
  foods  Foods[]
}

model Foods {
  id                  Int                @id @default(autoincrement())
  name                String
  image               String
  desc                String
  price               Int
  order               Int                   @default(0)
  rating              Float                 @default(0)
  type                TypeFood              @relation(fields: [typeId], references: [id])
  typeId              Int
  categorie           CategorieFood         @relation(fields: [categorieId], references: [id])
  categorieId         Int
  commentsFood        CommentsFood[]
  favoriteId          Int?
  favorite            Favorite?             @relation(fields: [favoriteId], references: [id])
  branchId            Int
  branch              Branchs               @relation(fields: [branchId], references: [id])
  specialOffer        Boolean               @default(false)
  numberOfSell        Int                   @default(0)
  foodOfOrderTracking FoodOfOrderTracking[]
}

model Addresses {
  id           Int   @id @default(autoincrement())
  titleAddress String
  meReciver    Boolean?
  phone        String
  nameReciver  String?
  address      String
  user         User     @relation(fields: [userId], references: [id])
  userId       Int
}

model TypeFood {
  id   Int  @id @default(autoincrement())
  name String  @unique
  food Foods[]
}

model CategorieFood {
  id   Int  @id @default(autoincrement())
  name String
  food Foods[]
}

model CommentsFood {
  id        Int   @id @default(autoincrement())
  desc      String
  score     Float
  user      User     @relation(fields: [userId], references: [id])
  userId    Int
  createdAt DateTime @default(now())
  public    Boolean? @default(false)
  food      Foods    @relation(fields: [foodId], references: [id])
  foodId    Int
}

model CommentsBranch {
  id        Int   @id @default(autoincrement())
  desc      String
  score     Float
  userId    Int
  user      User     @relation(fields: [userId], references: [id])
  branchId  Int?
  branch    Branchs? @relation(fields: [branchId], references: [id])
  public    Boolean? @default(false)
  createdAt DateTime @default(now())
}

model Branchs {
  id             Int           @id @default(autoincrement())
  name           String           @unique
  nickName       String           @unique
  address        String
  phones         String
  images         String
  foods          Foods[]
  commentsBranch CommentsBranch[]
}

model OrderTracking {
  id              Int                @id @default(autoincrement())
  branchId        Int
  foods           FoodOfOrderTracking[]
  price           Int
  discount        Int
  userId          Int
  user            User                  @relation(fields: [userId], references: [id])
  date            DateTime              @default(now())
  sendMethodId    Int
  sendMethod      SendMethod            @relation(fields: [sendMethodId], references: [id])
  statusId        Int
  status          StatusOfOrderTracking @relation(fields: [statusId], references: [id])
  paymentMethodId Int
  paymentMethod   PaymentMethod         @relation(fields: [paymentMethodId], references: [id])
}

model SendMethod {
  id         Int          @id @default(autoincrement())
  name       String
  orderTrack OrderTracking[]
}

model StatusOfOrderTracking {
  id         Int          @id @default(autoincrement())
  name       String
  orderTrack OrderTracking[]
}

model PaymentMethod {
  id         Int          @id @default(autoincrement())
  name       String
  orderTrack OrderTracking[]
}

model FoodOfOrderTracking {
  id           Int        @id @default(autoincrement())
  foodId       Int
  food         Foods         @relation(fields: [foodId], references: [id])
  orderTrackId Int
  orderTrack   OrderTracking @relation(fields: [orderTrackId], references: [id])
  quantity     Int
}
